# 네트워크 연결 문제 디버깅 가이드

## 🔍 단계별 확인 사항

### 1. 백엔드 서버 재시작 확인

**중요:** 백엔드 서버 코드를 수정했으므로 **반드시 재시작**해야 합니다.

```bash
# 백엔드 서버 중지 (Ctrl + C)
# 다시 시작
cd backend
npm run dev
```

서버가 시작되면 다음과 같은 메시지가 표시되어야 합니다:
```
🚀 백엔드 서버가 시작되었습니다!
🌍 Network Access: http://0.0.0.0:3000/api
💡 모든 네트워크 인터페이스에서 접근 가능합니다.
```

### 2. 프론트엔드 콘솔 확인

앱에서 요청을 시도할 때 콘솔에 다음 로그가 표시됩니다:

```
📤 [API] OUTGOING REQUEST
Method: GET
URL: http://192.168.219.108:3000/api/books/daily/1
Endpoint: /books/daily/1
Has Token: Yes/No
```

이 로그를 확인하여:
- ✅ URL이 올바른지 확인
- ✅ 토큰이 있는지 확인

### 3. 백엔드 콘솔 확인

백엔드 서버 콘솔에서 다음을 확인하세요:

**요청이 도착하는 경우:**
```
================================================================================
[2024-01-01T12:00:00.000Z] 📥 INCOMING REQUEST
Method: GET
URL: /api/books/daily/1
Path: /api/books/daily/1
User ID: anonymous
IP: 192.168.219.xxx
================================================================================
```

**요청이 도착하지 않는 경우:**
- 백엔드 콘솔에 아무 로그도 없음
- 이 경우 네트워크 연결 문제일 가능성이 높음

### 4. 네트워크 연결 테스트

**PowerShell에서 직접 테스트:**

```powershell
# Health Check 테스트
Invoke-WebRequest -Uri http://192.168.219.108:3000/health

# API 엔드포인트 테스트 (인증 필요)
Invoke-WebRequest -Uri http://192.168.219.108:3000/api/books/daily/1 -Headers @{"Authorization"="Bearer YOUR_TOKEN"}
```

### 5. 방화벽 확인

Windows 방화벽이 포트 3000을 차단하고 있을 수 있습니다.

**방화벽 확인:**
1. Windows 설정 → 네트워크 및 인터넷 → Windows 방화벽
2. 고급 설정 → 인바운드 규칙
3. 포트 3000이 허용되어 있는지 확인

**임시로 방화벽 비활성화 테스트:**
- 개발 중에만 임시로 비활성화하여 테스트
- 문제가 해결되면 방화벽 규칙 추가

### 6. 백엔드 서버 바인딩 확인

백엔드 서버가 `0.0.0.0`에서 리스닝하는지 확인:

```javascript
// backend/src/index.js
app.listen(PORT, '0.0.0.0', () => {
  // ...
});
```

이 설정이 되어 있어야 다른 IP에서 접근 가능합니다.

## 🐛 일반적인 문제와 해결 방법

### 문제 1: 백엔드 콘솔에 요청이 안 보임

**원인:** 네트워크 연결 문제 또는 방화벽

**해결:**
1. 백엔드 서버가 `0.0.0.0`에서 리스닝하는지 확인
2. 방화벽 설정 확인
3. 같은 네트워크에 있는지 확인

### 문제 2: CORS 에러

**원인:** 백엔드 CORS 설정 문제

**해결:**
- 백엔드 `.env` 파일에서 `CORS_ORIGIN=*` 확인
- 또는 프론트엔드 origin을 명시적으로 추가

### 문제 3: "Failed to fetch" 에러

**원인:** 여러 가지 가능

**해결:**
1. 백엔드 서버 실행 확인
2. 백엔드 서버 재시작
3. 네트워크 연결 확인
4. 방화벽 확인

## 📋 체크리스트

- [ ] 백엔드 서버가 실행 중인가?
- [ ] 백엔드 서버가 `0.0.0.0`에서 리스닝하는가?
- [ ] 백엔드 서버를 재시작했는가?
- [ ] 프론트엔드 콘솔에서 요청 URL이 올바른가?
- [ ] 백엔드 콘솔에서 요청이 도착하는가?
- [ ] 방화벽이 포트 3000을 차단하지 않는가?
- [ ] Health Check가 작동하는가?

## 💡 빠른 해결 방법

1. **백엔드 서버 재시작:**
   ```bash
   cd backend
   npm run dev
   ```

2. **프론트엔드 앱에서 요청 시도**

3. **백엔드 콘솔 확인:**
   - 요청이 도착하는지 확인
   - 에러 메시지 확인

4. **프론트엔드 콘솔 확인:**
   - 요청 URL 확인
   - 에러 메시지 확인

